************************************************************************************************************************
ViTBasicForImageClassification(
  (embedding_layer): Sequential(
    (0): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    (1): Rearrange('b d ph pw -> b (ph pw) d')
  )
  (additional_class_tokens): ParameterList(
      (0): Parameter containing: [torch.float32 of size 1x1x768 (GPU 0)]
      (1): Parameter containing: [torch.float32 of size 1x1x768 (GPU 0)]
  )
  (mlp_heads): ModuleList(
    (0): Linear(in_features=768, out_features=2, bias=True)
    (1): Linear(in_features=768, out_features=10, bias=True)
  )
  (positional_embedding): PositionalEmbedding1D()
  (transformer_encoder): TransformerEncoder(
    (tf_blocks): ModuleList(
      (0-11): 12 x TransformerBlock(
        (mha): MultiHeadAttention(
          (query_layer): Linear(in_features=768, out_features=768, bias=True)
          (key_layer): Linear(in_features=768, out_features=768, bias=True)
          (value_layer): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
        )
        (layer_norm_1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (pos_wise_ff_layer): PositionWiseFeedForward(
          (pos_wise_feed_forward): Sequential(
            (0): Linear(in_features=768, out_features=3072, bias=True)
            (1): GELU(approximate='none')
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=3072, out_features=768, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (layer_norm_2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (final_layer_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
Experiment:  vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564729
Starting Broad Fine Alternate Class Training...
Starting Train/Eval...

Epoch: 0
Mode: MODE.TRAIN
Losses: 2.47558856010437
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.078125}
Best Acc@1_fine till now: -1

Train Metrics increased from: -1 -> 0.078125

Epoch: 0
Mode: MODE.EVAL
Losses: 1.5268004834651947
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: -1

Eval Metrics increased from: -1 -> 0.109375
Model CKPT saved at: ./checkpoints/vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564729.pt
Epoch took 3.65 s

Epoch: 1
Mode: MODE.TRAIN
Losses: 0.6062917113304138
Metrics: {'Acc@1_broad': 0.734375, 'Acc@1_fine': 0.0625}
Best Acc@1_fine till now: 0.078125


Epoch: 1
Mode: MODE.EVAL
Losses: 1.5200304985046387
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.09375}
Best Acc@1_fine till now: 0.109375

Epoch took 2.28 s

Epoch: 2
Mode: MODE.TRAIN
Losses: 0.8122562170028687
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.078125

Train Metrics increased from: 0.078125 -> 0.109375

Epoch: 2
Mode: MODE.EVAL
Losses: 1.5118907988071442
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.078125}
Best Acc@1_fine till now: 0.109375

Epoch took 2.31 s

Epoch: 3
Mode: MODE.TRAIN
Losses: 0.6341699957847595
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.109375

Train Metrics increased from: 0.109375 -> 0.171875

Epoch: 3
Mode: MODE.EVAL
Losses: 1.416106402873993
Metrics: {'Acc@1_broad': 0.75, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.109375

Eval Metrics increased from: 0.109375 -> 0.15625
Model CKPT saved at: ./checkpoints/vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564729.pt
Epoch took 4.70 s

Epoch: 4
Mode: MODE.TRAIN
Losses: 0.7004275321960449
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.171875


Epoch: 4
Mode: MODE.EVAL
Losses: 1.4430736899375916
Metrics: {'Acc@1_broad': 0.703125, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.15625

Epoch took 2.35 s

Epoch: 5
Mode: MODE.TRAIN
Losses: 0.467467725276947
Metrics: {'Acc@1_broad': 0.8125, 'Acc@1_fine': 0.03125}
Best Acc@1_fine till now: 0.171875


Epoch: 5
Mode: MODE.EVAL
Losses: 1.4089247584342957
Metrics: {'Acc@1_broad': 0.703125, 'Acc@1_fine': 0.140625}
Best Acc@1_fine till now: 0.15625

Epoch took 2.31 s

Epoch: 6
Mode: MODE.TRAIN
Losses: 0.6156376600265503
Metrics: {'Acc@1_broad': 0.671875, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.171875


Epoch: 6
Mode: MODE.EVAL
Losses: 1.4268554151058197
Metrics: {'Acc@1_broad': 0.78125, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.15625

Epoch took 2.32 s

Epoch: 7
Mode: MODE.TRAIN
Losses: 0.5152190923690796
Metrics: {'Acc@1_broad': 0.703125, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.171875


Epoch: 7
Mode: MODE.EVAL
Losses: 1.4092833995819092
Metrics: {'Acc@1_broad': 0.84375, 'Acc@1_fine': 0.03125}
Best Acc@1_fine till now: 0.15625

Epoch took 2.33 s

Epoch: 8
Mode: MODE.TRAIN
Losses: 0.5486630797386169
Metrics: {'Acc@1_broad': 0.75, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.171875


Epoch: 8
Mode: MODE.EVAL
Losses: 1.4083091616630554
Metrics: {'Acc@1_broad': 0.765625, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.15625

Epoch took 2.28 s

Epoch: 9
Mode: MODE.TRAIN
Losses: 0.5058815479278564
Metrics: {'Acc@1_broad': 0.765625, 'Acc@1_fine': 0.078125}
Best Acc@1_fine till now: 0.171875


Epoch: 9
Mode: MODE.EVAL
Losses: 1.3787921667099
Metrics: {'Acc@1_broad': 0.765625, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.15625

Epoch took 2.24 s

Epoch: 10
Mode: MODE.TRAIN
Losses: 0.476742684841156
Metrics: {'Acc@1_broad': 0.78125, 'Acc@1_fine': 0.09375}
Best Acc@1_fine till now: 0.171875


Epoch: 10
Mode: MODE.EVAL
Losses: 1.40745347738266
Metrics: {'Acc@1_broad': 0.765625, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.15625

Epoch took 2.25 s

Epoch: 11
Mode: MODE.TRAIN
Losses: 0.38039809465408325
Metrics: {'Acc@1_broad': 0.875, 'Acc@1_fine': 0.0625}
Best Acc@1_fine till now: 0.171875


Epoch: 11
Mode: MODE.EVAL
Losses: 1.3860111832618713
Metrics: {'Acc@1_broad': 0.71875, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.15625

Epoch took 2.32 s

Epoch: 12
Mode: MODE.TRAIN
Losses: 0.5188076496124268
Metrics: {'Acc@1_broad': 0.703125, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.171875


Epoch: 12
Mode: MODE.EVAL
Losses: 1.4263883233070374
Metrics: {'Acc@1_broad': 0.796875, 'Acc@1_fine': 0.0625}
Best Acc@1_fine till now: 0.15625

Epoch took 2.27 s

Epoch: 13
Mode: MODE.TRAIN
Losses: 0.5472720861434937
Metrics: {'Acc@1_broad': 0.734375, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.171875


Epoch: 13
Mode: MODE.EVAL
Losses: 1.3855970352888107
Metrics: {'Acc@1_broad': 0.828125, 'Acc@1_fine': 0.078125}
Best Acc@1_fine till now: 0.15625

Epoch took 2.27 s

Epoch: 14
Mode: MODE.TRAIN
Losses: 0.5008893609046936
Metrics: {'Acc@1_broad': 0.734375, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.171875


Epoch: 14
Mode: MODE.EVAL
Losses: 1.5022948682308197
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.046875}
Best Acc@1_fine till now: 0.15625

Epoch took 2.31 s

Epoch: 15
Mode: MODE.TRAIN
Losses: 0.42629754543304443
Metrics: {'Acc@1_broad': 0.765625, 'Acc@1_fine': 0.046875}
Best Acc@1_fine till now: 0.171875


Epoch: 15
Mode: MODE.EVAL
Losses: 1.4304729253053665
Metrics: {'Acc@1_broad': 0.71875, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.15625

Epoch took 2.26 s
