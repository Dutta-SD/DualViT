************************************************************************************************************************
ViTBasicForImageClassification(
  (embedding_layer): Sequential(
    (0): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
    (1): Rearrange('b d ph pw -> b (ph pw) d')
  )
  (additional_class_tokens): ParameterList(
      (0): Parameter containing: [torch.float32 of size 1x1x768 (GPU 0)]
      (1): Parameter containing: [torch.float32 of size 1x1x768 (GPU 0)]
  )
  (mlp_heads): ModuleList(
    (0): Linear(in_features=768, out_features=2, bias=True)
    (1): Linear(in_features=768, out_features=10, bias=True)
  )
  (positional_embedding): PositionalEmbedding1D()
  (transformer_encoder): TransformerEncoder(
    (tf_blocks): ModuleList(
      (0-11): 12 x TransformerBlock(
        (mha): MultiHeadAttention(
          (query_layer): Linear(in_features=768, out_features=768, bias=True)
          (key_layer): Linear(in_features=768, out_features=768, bias=True)
          (value_layer): Linear(in_features=768, out_features=768, bias=True)
          (out_proj): Linear(in_features=768, out_features=768, bias=True)
          (dropout): Dropout(p=0.0, inplace=False)
        )
        (layer_norm_1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (pos_wise_ff_layer): PositionWiseFeedForward(
          (pos_wise_feed_forward): Sequential(
            (0): Linear(in_features=768, out_features=3072, bias=True)
            (1): GELU(approximate='none')
            (2): Dropout(p=0.0, inplace=False)
            (3): Linear(in_features=3072, out_features=768, bias=True)
            (4): Dropout(p=0.0, inplace=False)
          )
        )
        (layer_norm_2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
  )
  (final_layer_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
)
Experiment:  vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564917
Starting Broad Fine Alternate Class Training...
Starting Train/Eval...

Epoch: 0
Mode: MODE.TRAIN
Losses: 0.6495742797851562
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.078125}
Best Acc@1_fine till now: -1

Train Metrics increased from: -1 -> 0.078125

Epoch: 0
Mode: MODE.EVAL
Losses: 1.592971920967102
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: -1

Eval Metrics increased from: -1 -> 0.109375
Model CKPT saved at: ./checkpoints/vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564917.pt
Epoch took 3.64 s

Epoch: 1
Mode: MODE.TRAIN
Losses: 2.627852201461792
Metrics: {'Acc@1_broad': 0.53125, 'Acc@1_fine': 0.046875}
Best Acc@1_fine till now: 0.078125


Epoch: 1
Mode: MODE.EVAL
Losses: 1.553773671388626
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.109375

Eval Metrics increased from: 0.109375 -> 0.1875
Model CKPT saved at: ./checkpoints/vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564917.pt
Epoch took 4.31 s

Epoch: 2
Mode: MODE.TRAIN
Losses: 2.32611346244812
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.078125

Train Metrics increased from: 0.078125 -> 0.109375

Epoch: 2
Mode: MODE.EVAL
Losses: 1.4986112117767334
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.140625}
Best Acc@1_fine till now: 0.1875

Epoch took 2.27 s

Epoch: 3
Mode: MODE.TRAIN
Losses: 2.285813093185425
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.140625}
Best Acc@1_fine till now: 0.109375

Train Metrics increased from: 0.109375 -> 0.140625

Epoch: 3
Mode: MODE.EVAL
Losses: 1.4819954931735992
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.28125}
Best Acc@1_fine till now: 0.1875

Eval Metrics increased from: 0.1875 -> 0.28125
Model CKPT saved at: ./checkpoints/vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564917.pt
Epoch took 4.52 s

Epoch: 4
Mode: MODE.TRAIN
Losses: 2.280674695968628
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.140625

Train Metrics increased from: 0.140625 -> 0.15625

Epoch: 4
Mode: MODE.EVAL
Losses: 1.4830164909362793
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.28125

Epoch took 2.34 s

Epoch: 5
Mode: MODE.TRAIN
Losses: 2.2763888835906982
Metrics: {'Acc@1_broad': 0.734375, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.15625

Train Metrics increased from: 0.15625 -> 0.171875

Epoch: 5
Mode: MODE.EVAL
Losses: 1.4366132318973541
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.203125}
Best Acc@1_fine till now: 0.28125

Epoch took 2.22 s

Epoch: 6
Mode: MODE.TRAIN
Losses: 2.286238670349121
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.171875


Epoch: 6
Mode: MODE.EVAL
Losses: 1.431683897972107
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.28125

Epoch took 2.31 s

Epoch: 7
Mode: MODE.TRAIN
Losses: 2.1699774265289307
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.25}
Best Acc@1_fine till now: 0.171875

Train Metrics increased from: 0.171875 -> 0.25

Epoch: 7
Mode: MODE.EVAL
Losses: 1.4264193177223206
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.28125

Epoch took 2.31 s

Epoch: 8
Mode: MODE.TRAIN
Losses: 2.2035040855407715
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.25


Epoch: 8
Mode: MODE.EVAL
Losses: 1.445298582315445
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.28125}
Best Acc@1_fine till now: 0.28125

Epoch took 2.30 s

Epoch: 9
Mode: MODE.TRAIN
Losses: 2.164508819580078
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.234375}
Best Acc@1_fine till now: 0.25


Epoch: 9
Mode: MODE.EVAL
Losses: 1.3748193681240082
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.25}
Best Acc@1_fine till now: 0.28125

Epoch took 2.28 s

Epoch: 10
Mode: MODE.TRAIN
Losses: 2.082197666168213
Metrics: {'Acc@1_broad': 0.6875, 'Acc@1_fine': 0.25}
Best Acc@1_fine till now: 0.25


Epoch: 10
Mode: MODE.EVAL
Losses: 1.4000172913074493
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.296875}
Best Acc@1_fine till now: 0.28125

Eval Metrics increased from: 0.28125 -> 0.296875
Model CKPT saved at: ./checkpoints/vit-b-16-cifar10-full-train-fine-broad-alternate-30-epochs_1693564917.pt
Epoch took 4.43 s

Epoch: 11
Mode: MODE.TRAIN
Losses: 2.1206648349761963
Metrics: {'Acc@1_broad': 0.703125, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.25


Epoch: 11
Mode: MODE.EVAL
Losses: 1.4113333523273468
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.203125}
Best Acc@1_fine till now: 0.296875

Epoch took 2.30 s

Epoch: 12
Mode: MODE.TRAIN
Losses: 2.1867988109588623
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.25


Epoch: 12
Mode: MODE.EVAL
Losses: 1.4316367208957672
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.234375}
Best Acc@1_fine till now: 0.296875

Epoch took 2.21 s

Epoch: 13
Mode: MODE.TRAIN
Losses: 2.1525821685791016
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.125}
Best Acc@1_fine till now: 0.25


Epoch: 13
Mode: MODE.EVAL
Losses: 1.4114764630794525
Metrics: {'Acc@1_broad': 0.671875, 'Acc@1_fine': 0.265625}
Best Acc@1_fine till now: 0.296875

Epoch took 2.25 s

Epoch: 14
Mode: MODE.TRAIN
Losses: 2.1444754600524902
Metrics: {'Acc@1_broad': 0.6875, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.25


Epoch: 14
Mode: MODE.EVAL
Losses: 1.648789882659912
Metrics: {'Acc@1_broad': 0.4375, 'Acc@1_fine': 0.203125}
Best Acc@1_fine till now: 0.296875

Epoch took 2.27 s

Epoch: 15
Mode: MODE.TRAIN
Losses: 2.1012070178985596
Metrics: {'Acc@1_broad': 0.78125, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.25


Epoch: 15
Mode: MODE.EVAL
Losses: 1.3738106787204742
Metrics: {'Acc@1_broad': 0.625, 'Acc@1_fine': 0.296875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.26 s

Epoch: 16
Mode: MODE.TRAIN
Losses: 2.1435978412628174
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.25


Epoch: 16
Mode: MODE.EVAL
Losses: 1.4638632237911224
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.26 s

Epoch: 17
Mode: MODE.TRAIN
Losses: 2.1147711277008057
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.28125}
Best Acc@1_fine till now: 0.25

Train Metrics increased from: 0.25 -> 0.28125

Epoch: 17
Mode: MODE.EVAL
Losses: 1.3862255215644836
Metrics: {'Acc@1_broad': 0.703125, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.25 s

Epoch: 18
Mode: MODE.TRAIN
Losses: 2.05501127243042
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.28125


Epoch: 18
Mode: MODE.EVAL
Losses: 1.3520720899105072
Metrics: {'Acc@1_broad': 0.671875, 'Acc@1_fine': 0.234375}
Best Acc@1_fine till now: 0.296875

Epoch took 2.27 s

Epoch: 19
Mode: MODE.TRAIN
Losses: 2.0758984088897705
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.28125


Epoch: 19
Mode: MODE.EVAL
Losses: 1.5703112483024597
Metrics: {'Acc@1_broad': 0.5, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.22 s

Epoch: 20
Mode: MODE.TRAIN
Losses: 2.1314690113067627
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.28125


Epoch: 20
Mode: MODE.EVAL
Losses: 1.4828210175037384
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.203125}
Best Acc@1_fine till now: 0.296875

Epoch took 2.25 s

Epoch: 21
Mode: MODE.TRAIN
Losses: 2.1206719875335693
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.234375}
Best Acc@1_fine till now: 0.28125


Epoch: 21
Mode: MODE.EVAL
Losses: 1.451363354921341
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.140625}
Best Acc@1_fine till now: 0.296875

Epoch took 2.24 s

Epoch: 22
Mode: MODE.TRAIN
Losses: 2.2135863304138184
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.28125


Epoch: 22
Mode: MODE.EVAL
Losses: 1.4498171210289001
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.234375}
Best Acc@1_fine till now: 0.296875

Epoch took 2.29 s

Epoch: 23
Mode: MODE.TRAIN
Losses: 2.1393721103668213
Metrics: {'Acc@1_broad': 0.734375, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.28125


Epoch: 23
Mode: MODE.EVAL
Losses: 1.4406321048736572
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.20 s

Epoch: 24
Mode: MODE.TRAIN
Losses: 2.168067455291748
Metrics: {'Acc@1_broad': 0.5625, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.28125


Epoch: 24
Mode: MODE.EVAL
Losses: 1.5811980962753296
Metrics: {'Acc@1_broad': 0.546875, 'Acc@1_fine': 0.078125}
Best Acc@1_fine till now: 0.296875

Epoch took 2.22 s

Epoch: 25
Mode: MODE.TRAIN
Losses: 2.0971128940582275
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.28125


Epoch: 25
Mode: MODE.EVAL
Losses: 1.3772302567958832
Metrics: {'Acc@1_broad': 0.65625, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.24 s

Epoch: 26
Mode: MODE.TRAIN
Losses: 2.1401193141937256
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.28125


Epoch: 26
Mode: MODE.EVAL
Losses: 1.434498369693756
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.27 s

Epoch: 27
Mode: MODE.TRAIN
Losses: 2.071820020675659
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.296875}
Best Acc@1_fine till now: 0.28125

Train Metrics increased from: 0.28125 -> 0.296875

Epoch: 27
Mode: MODE.EVAL
Losses: 1.4523753821849823
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.26 s

Epoch: 28
Mode: MODE.TRAIN
Losses: 2.118393659591675
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.296875


Epoch: 28
Mode: MODE.EVAL
Losses: 1.406769871711731
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.22 s

Epoch: 29
Mode: MODE.TRAIN
Losses: 2.1386706829071045
Metrics: {'Acc@1_broad': 0.59375, 'Acc@1_fine': 0.203125}
Best Acc@1_fine till now: 0.296875


Epoch: 29
Mode: MODE.EVAL
Losses: 1.4414789974689484
Metrics: {'Acc@1_broad': 0.5625, 'Acc@1_fine': 0.25}
Best Acc@1_fine till now: 0.296875

Epoch took 2.26 s

Epoch: 30
Mode: MODE.TRAIN
Losses: 0.734585165977478
Metrics: {'Acc@1_broad': 0.640625, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.296875


Epoch: 30
Mode: MODE.EVAL
Losses: 1.472790002822876
Metrics: {'Acc@1_broad': 0.53125, 'Acc@1_fine': 0.1875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.27 s

Epoch: 31
Mode: MODE.TRAIN
Losses: 2.052583694458008
Metrics: {'Acc@1_broad': 0.71875, 'Acc@1_fine': 0.21875}
Best Acc@1_fine till now: 0.296875


Epoch: 31
Mode: MODE.EVAL
Losses: 1.4991182088851929
Metrics: {'Acc@1_broad': 0.53125, 'Acc@1_fine': 0.140625}
Best Acc@1_fine till now: 0.296875

Epoch took 2.31 s

Epoch: 32
Mode: MODE.TRAIN
Losses: 2.2063610553741455
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.15625}
Best Acc@1_fine till now: 0.296875


Epoch: 32
Mode: MODE.EVAL
Losses: 1.4351688623428345
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.296875

Epoch took 2.26 s

Epoch: 33
Mode: MODE.TRAIN
Losses: 2.14098858833313
Metrics: {'Acc@1_broad': 0.609375, 'Acc@1_fine': 0.171875}
Best Acc@1_fine till now: 0.296875


Epoch: 33
Mode: MODE.EVAL
Losses: 1.4702265560626984
Metrics: {'Acc@1_broad': 0.578125, 'Acc@1_fine': 0.109375}
Best Acc@1_fine till now: 0.296875

Epoch took 2.30 s
