************************************************************************************************************************
Started at:  2023_09_26_00_10_55
Experiment:  tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259
Starting Dual Model Training Training with Modified Loss ...
Starting Train/Eval...

CURR EPOCH:  0

Epoch: 0 Summary
Mode: MODE.TRAIN
Losses: [12.5716749  0.547968 ]
Metrics: {'Acc@1_broad': 0.55082, 'Acc@1_fine': 0.8044}
Best Acc@1_fine till now: -1

Train Metrics increased from: -1 -> 0.8044000267982483

Epoch: 0 Summary
Mode: MODE.EVAL
Losses: [8.06085743 0.22456244]
Metrics: {'Acc@1_broad': 0.5186, 'Acc@1_fine': 0.9217}
Best Acc@1_fine till now: -1

Eval Metrics increased from: -1 -> 0.9217000007629395
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2367.62 s

CURR EPOCH:  1

Epoch: 1 Summary
Mode: MODE.TRAIN
Losses: [7.2919683  0.26009774]
Metrics: {'Acc@1_broad': 0.4936, 'Acc@1_fine': 0.9112}
Best Acc@1_fine till now: 0.8044000267982483

Train Metrics increased from: 0.8044000267982483 -> 0.9111999869346619

Epoch: 1 Summary
Mode: MODE.EVAL
Losses: [6.89433719 0.19349022]
Metrics: {'Acc@1_broad': 0.4928, 'Acc@1_fine': 0.9362}
Best Acc@1_fine till now: 0.9217000007629395

Eval Metrics increased from: 0.9217000007629395 -> 0.9362000226974487
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2375.96 s

CURR EPOCH:  2

Epoch: 2 Summary
Mode: MODE.TRAIN
Losses: [6.81893168 0.21197312]
Metrics: {'Acc@1_broad': 0.47778, 'Acc@1_fine': 0.92754}
Best Acc@1_fine till now: 0.9111999869346619

Train Metrics increased from: 0.9111999869346619 -> 0.9275400042533875

Epoch: 2 Summary
Mode: MODE.EVAL
Losses: [6.67859042 0.18084331]
Metrics: {'Acc@1_broad': 0.4694, 'Acc@1_fine': 0.9395}
Best Acc@1_fine till now: 0.9362000226974487

Eval Metrics increased from: 0.9362000226974487 -> 0.9394999742507935
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2373.00 s

CURR EPOCH:  3

Epoch: 3 Summary
Mode: MODE.TRAIN
Losses: [6.67326606 0.17917265]
Metrics: {'Acc@1_broad': 0.43368, 'Acc@1_fine': 0.93782}
Best Acc@1_fine till now: 0.9275400042533875

Train Metrics increased from: 0.9275400042533875 -> 0.9378200173377991

Epoch: 3 Summary
Mode: MODE.EVAL
Losses: [6.55962021 0.16446215]
Metrics: {'Acc@1_broad': 0.4176, 'Acc@1_fine': 0.9447}
Best Acc@1_fine till now: 0.9394999742507935

Eval Metrics increased from: 0.9394999742507935 -> 0.9447000026702881
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.66 s

CURR EPOCH:  4

Epoch: 4 Summary
Mode: MODE.TRAIN
Losses: [6.58092402 0.15681213]
Metrics: {'Acc@1_broad': 0.41704, 'Acc@1_fine': 0.94506}
Best Acc@1_fine till now: 0.9378200173377991

Train Metrics increased from: 0.9378200173377991 -> 0.9450600147247314

Epoch: 4 Summary
Mode: MODE.EVAL
Losses: [6.65628565 0.14266061]
Metrics: {'Acc@1_broad': 0.3953, 'Acc@1_fine': 0.9541}
Best Acc@1_fine till now: 0.9447000026702881

Eval Metrics increased from: 0.9447000026702881 -> 0.9541000127792358
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.44 s

CURR EPOCH:  5

Epoch: 5 Summary
Mode: MODE.TRAIN
Losses: [6.56198554 0.13938114]
Metrics: {'Acc@1_broad': 0.38912, 'Acc@1_fine': 0.9513}
Best Acc@1_fine till now: 0.9450600147247314

Train Metrics increased from: 0.9450600147247314 -> 0.9513000249862671

Epoch: 5 Summary
Mode: MODE.EVAL
Losses: [6.56699272 0.13716306]
Metrics: {'Acc@1_broad': 0.3761, 'Acc@1_fine': 0.9553}
Best Acc@1_fine till now: 0.9541000127792358

Eval Metrics increased from: 0.9541000127792358 -> 0.955299973487854
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.58 s

CURR EPOCH:  6

Epoch: 6 Summary
Mode: MODE.TRAIN
Losses: [6.60647594 0.12026073]
Metrics: {'Acc@1_broad': 0.38024, 'Acc@1_fine': 0.95752}
Best Acc@1_fine till now: 0.9513000249862671

Train Metrics increased from: 0.9513000249862671 -> 0.9575200080871582

Epoch: 6 Summary
Mode: MODE.EVAL
Losses: [6.55449621 0.140064  ]
Metrics: {'Acc@1_broad': 0.3613, 'Acc@1_fine': 0.9557}
Best Acc@1_fine till now: 0.955299973487854

Eval Metrics increased from: 0.955299973487854 -> 0.9556999802589417
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.70 s

CURR EPOCH:  7

Epoch: 7 Summary
Mode: MODE.TRAIN
Losses: [6.61484312 0.10671134]
Metrics: {'Acc@1_broad': 0.37048, 'Acc@1_fine': 0.9625}
Best Acc@1_fine till now: 0.9575200080871582

Train Metrics increased from: 0.9575200080871582 -> 0.9624999761581421

Epoch: 7 Summary
Mode: MODE.EVAL
Losses: [6.64514711 0.14825373]
Metrics: {'Acc@1_broad': 0.3522, 'Acc@1_fine': 0.9551}
Best Acc@1_fine till now: 0.9556999802589417

Epoch took 2362.33 s

CURR EPOCH:  8

Epoch: 8 Summary
Mode: MODE.TRAIN
Losses: [6.66330821 0.09262906]
Metrics: {'Acc@1_broad': 0.36172, 'Acc@1_fine': 0.9667}
Best Acc@1_fine till now: 0.9624999761581421

Train Metrics increased from: 0.9624999761581421 -> 0.96670001745224

Epoch: 8 Summary
Mode: MODE.EVAL
Losses: [6.76170528 0.15869728]
Metrics: {'Acc@1_broad': 0.3329, 'Acc@1_fine': 0.9525}
Best Acc@1_fine till now: 0.9556999802589417

Epoch took 2362.08 s

CURR EPOCH:  9

Epoch: 9 Summary
Mode: MODE.TRAIN
Losses: [6.67530658 0.08310093]
Metrics: {'Acc@1_broad': 0.36734, 'Acc@1_fine': 0.97056}
Best Acc@1_fine till now: 0.96670001745224

Train Metrics increased from: 0.96670001745224 -> 0.9705600142478943

Epoch: 9 Summary
Mode: MODE.EVAL
Losses: [6.70142835 0.15850747]
Metrics: {'Acc@1_broad': 0.3924, 'Acc@1_fine': 0.9556}
Best Acc@1_fine till now: 0.9556999802589417

Epoch took 2362.22 s

CURR EPOCH:  10

Epoch: 10 Summary
Mode: MODE.TRAIN
Losses: [6.69116401 0.07489155]
Metrics: {'Acc@1_broad': 0.38376, 'Acc@1_fine': 0.9744}
Best Acc@1_fine till now: 0.9705600142478943

Train Metrics increased from: 0.9705600142478943 -> 0.974399983882904

Epoch: 10 Summary
Mode: MODE.EVAL
Losses: [6.65374013 0.15755264]
Metrics: {'Acc@1_broad': 0.3329, 'Acc@1_fine': 0.9562}
Best Acc@1_fine till now: 0.9556999802589417

Eval Metrics increased from: 0.9556999802589417 -> 0.9562000036239624
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.86 s

CURR EPOCH:  11

Epoch: 11 Summary
Mode: MODE.TRAIN
Losses: [6.73038455 0.0628642 ]
Metrics: {'Acc@1_broad': 0.3653, 'Acc@1_fine': 0.97724}
Best Acc@1_fine till now: 0.974399983882904

Train Metrics increased from: 0.974399983882904 -> 0.9772400259971619

Epoch: 11 Summary
Mode: MODE.EVAL
Losses: [6.70902742 0.16378389]
Metrics: {'Acc@1_broad': 0.3425, 'Acc@1_fine': 0.9559}
Best Acc@1_fine till now: 0.9562000036239624

Epoch took 2362.15 s

CURR EPOCH:  12

Epoch: 12 Summary
Mode: MODE.TRAIN
Losses: [6.66372799 0.05492086]
Metrics: {'Acc@1_broad': 0.34882, 'Acc@1_fine': 0.98012}
Best Acc@1_fine till now: 0.9772400259971619

Train Metrics increased from: 0.9772400259971619 -> 0.9801200032234192

Epoch: 12 Summary
Mode: MODE.EVAL
Losses: [6.78121714 0.14414955]
Metrics: {'Acc@1_broad': 0.3336, 'Acc@1_fine': 0.96}
Best Acc@1_fine till now: 0.9562000036239624

Eval Metrics increased from: 0.9562000036239624 -> 0.9599999785423279
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.65 s

CURR EPOCH:  13

Epoch: 13 Summary
Mode: MODE.TRAIN
Losses: [6.74482016 0.05016946]
Metrics: {'Acc@1_broad': 0.34594, 'Acc@1_fine': 0.98258}
Best Acc@1_fine till now: 0.9801200032234192

Train Metrics increased from: 0.9801200032234192 -> 0.9825800061225891

Epoch: 13 Summary
Mode: MODE.EVAL
Losses: [6.89110766 0.15283485]
Metrics: {'Acc@1_broad': 0.3216, 'Acc@1_fine': 0.9604}
Best Acc@1_fine till now: 0.9599999785423279

Eval Metrics increased from: 0.9599999785423279 -> 0.9603999853134155
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2371.31 s

CURR EPOCH:  14

Epoch: 14 Summary
Mode: MODE.TRAIN
Losses: [6.80043104 0.04563893]
Metrics: {'Acc@1_broad': 0.35354, 'Acc@1_fine': 0.98362}
Best Acc@1_fine till now: 0.9825800061225891

Train Metrics increased from: 0.9825800061225891 -> 0.9836199879646301

Epoch: 14 Summary
Mode: MODE.EVAL
Losses: [6.78792407 0.14922489]
Metrics: {'Acc@1_broad': 0.3392, 'Acc@1_fine': 0.9594}
Best Acc@1_fine till now: 0.9603999853134155

Epoch took 2361.97 s

CURR EPOCH:  15

Epoch: 15 Summary
Mode: MODE.TRAIN
Losses: [6.78002836 0.03878453]
Metrics: {'Acc@1_broad': 0.36154, 'Acc@1_fine': 0.98638}
Best Acc@1_fine till now: 0.9836199879646301

Train Metrics increased from: 0.9836199879646301 -> 0.9863799810409546

Epoch: 15 Summary
Mode: MODE.EVAL
Losses: [6.85936415 0.15482382]
Metrics: {'Acc@1_broad': 0.3481, 'Acc@1_fine': 0.9596}
Best Acc@1_fine till now: 0.9603999853134155

Epoch took 2362.47 s

CURR EPOCH:  16

Epoch: 16 Summary
Mode: MODE.TRAIN
Losses: [6.80747799 0.03509189]
Metrics: {'Acc@1_broad': 0.36766, 'Acc@1_fine': 0.9873}
Best Acc@1_fine till now: 0.9863799810409546

Train Metrics increased from: 0.9863799810409546 -> 0.9872999787330627

Epoch: 16 Summary
Mode: MODE.EVAL
Losses: [6.72094433 0.15381044]
Metrics: {'Acc@1_broad': 0.3499, 'Acc@1_fine': 0.9597}
Best Acc@1_fine till now: 0.9603999853134155

Epoch took 2363.04 s

CURR EPOCH:  17

Epoch: 17 Summary
Mode: MODE.TRAIN
Losses: [6.73708067 0.03185029]
Metrics: {'Acc@1_broad': 0.37122, 'Acc@1_fine': 0.989}
Best Acc@1_fine till now: 0.9872999787330627

Train Metrics increased from: 0.9872999787330627 -> 0.9890000224113464

Epoch: 17 Summary
Mode: MODE.EVAL
Losses: [6.76437999 0.15988515]
Metrics: {'Acc@1_broad': 0.3571, 'Acc@1_fine': 0.961}
Best Acc@1_fine till now: 0.9603999853134155

Eval Metrics increased from: 0.9603999853134155 -> 0.9610000252723694
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only-BNFCluster-loss_1695667259.pt
Epoch took 2372.08 s

CURR EPOCH:  18

Epoch: 18 Summary
Mode: MODE.TRAIN
Losses: [6.7919136  0.02598363]
Metrics: {'Acc@1_broad': 0.37864, 'Acc@1_fine': 0.99132}
Best Acc@1_fine till now: 0.9890000224113464

Train Metrics increased from: 0.9890000224113464 -> 0.991320013999939

Epoch: 18 Summary
Mode: MODE.EVAL
Losses: [6.82454296 0.17326914]
Metrics: {'Acc@1_broad': 0.3761, 'Acc@1_fine': 0.9585}
Best Acc@1_fine till now: 0.9610000252723694

Epoch took 2363.09 s

CURR EPOCH:  19
