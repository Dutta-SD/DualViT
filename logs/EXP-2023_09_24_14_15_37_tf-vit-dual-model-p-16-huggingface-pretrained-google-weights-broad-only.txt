************************************************************************************************************************
Started at:  2023_09_24_14_15_37
TPDualVit(
  (fine_model): TPVitImageClassification(
    (embedding_layer): Sequential(
      (0): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
      (1): Rearrange('b d ph pw -> b (ph pw) d')
    )
    (additional_class_tokens): ParameterList(  (0): Parameter containing: [torch.float32 of size 1x1x768])
    (mlp_heads): ModuleList(
      (0): Linear(in_features=768, out_features=10, bias=True)
    )
    (positional_embedding): PositionalEmbedding1D()
    (transformer_encoder): TPTransformerEncoder(
      (tf_blocks): ModuleList(
        (0-11): 12 x TPTransformerBlock(
          (mha): TPMHA(
            (query_layer): Linear(in_features=768, out_features=768, bias=True)
            (key_layer): Linear(in_features=768, out_features=768, bias=True)
            (value_layer): Linear(in_features=768, out_features=768, bias=True)
            (out_proj): Linear(in_features=768, out_features=768, bias=True)
            (dropout): Dropout(p=0.1, inplace=False)
            (repr_layer): Linear(in_features=768, out_features=768, bias=True)
          )
          (layer_norm_1): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (pos_wise_ff_layer): PositionWiseFeedForward(
            (pos_wise_feed_forward): Sequential(
              (0): Linear(in_features=768, out_features=3072, bias=True)
              (1): GELU(approximate='none')
              (2): Dropout(p=0.1, inplace=False)
              (3): Linear(in_features=3072, out_features=768, bias=True)
              (4): Dropout(p=0.1, inplace=False)
            )
          )
          (layer_norm_2): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (final_layer_norm): LayerNorm((768,), eps=1e-06, elementwise_affine=True)
  )
  (broad_model): ViTForImageClassification(
    (vit): ViTModel(
      (embeddings): ViTEmbeddings(
        (patch_embeddings): ViTPatchEmbeddings(
          (projection): Conv2d(3, 768, kernel_size=(16, 16), stride=(16, 16))
        )
        (dropout): Dropout(p=0.0, inplace=False)
      )
      (encoder): ViTEncoder(
        (layer): ModuleList(
          (0-11): 12 x ViTLayer(
            (attention): ViTAttention(
              (attention): ViTSelfAttention(
                (query): Linear(in_features=768, out_features=768, bias=True)
                (key): Linear(in_features=768, out_features=768, bias=True)
                (value): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.0, inplace=False)
              )
              (output): ViTSelfOutput(
                (dense): Linear(in_features=768, out_features=768, bias=True)
                (dropout): Dropout(p=0.0, inplace=False)
              )
            )
            (intermediate): ViTIntermediate(
              (dense): Linear(in_features=768, out_features=3072, bias=True)
              (intermediate_act_fn): GELUActivation()
            )
            (output): ViTOutput(
              (dense): Linear(in_features=3072, out_features=768, bias=True)
              (dropout): Dropout(p=0.0, inplace=False)
            )
            (layernorm_before): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
            (layernorm_after): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
          )
        )
      )
      (layernorm): LayerNorm((768,), eps=1e-12, elementwise_affine=True)
    )
    (classifier): Linear(in_features=768, out_features=2, bias=True)
  )
)
Experiment:  tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141
Starting Dual Model Training Training with Modified Loss ...
Starting Train/Eval...

CURR EPOCH:  0

Epoch: 0 Summary
Mode: MODE.TRAIN
Losses: [0.06665524 0.42723703]
Metrics: {'Acc@1_broad': 0.97586, 'Acc@1_fine': 0.85086}
Best Acc@1_fine till now: -1

Train Metrics increased from: -1 -> 0.8508599996566772

Epoch: 0 Summary
Mode: MODE.EVAL
Losses: [0.02026272 0.14602324]
Metrics: {'Acc@1_broad': 0.9941, 'Acc@1_fine': 0.9519}
Best Acc@1_fine till now: -1

Eval Metrics increased from: -1 -> 0.9519000053405762
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2366.82 s

CURR EPOCH:  1

Epoch: 1 Summary
Mode: MODE.TRAIN
Losses: [0.0395274  0.18499861]
Metrics: {'Acc@1_broad': 0.98632, 'Acc@1_fine': 0.93614}
Best Acc@1_fine till now: 0.8508599996566772

Train Metrics increased from: 0.8508599996566772 -> 0.9361400008201599

Epoch: 1 Summary
Mode: MODE.EVAL
Losses: [0.01480848 0.12187694]
Metrics: {'Acc@1_broad': 0.9953, 'Acc@1_fine': 0.9619}
Best Acc@1_fine till now: 0.9519000053405762

Eval Metrics increased from: 0.9519000053405762 -> 0.961899995803833
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2375.58 s

CURR EPOCH:  2

Epoch: 2 Summary
Mode: MODE.TRAIN
Losses: [0.03327515 0.14374558]
Metrics: {'Acc@1_broad': 0.98794, 'Acc@1_fine': 0.95026}
Best Acc@1_fine till now: 0.9361400008201599

Train Metrics increased from: 0.9361400008201599 -> 0.9502599835395813

Epoch: 2 Summary
Mode: MODE.EVAL
Losses: [0.01261751 0.10682998]
Metrics: {'Acc@1_broad': 0.9963, 'Acc@1_fine': 0.9647}
Best Acc@1_fine till now: 0.961899995803833

Eval Metrics increased from: 0.961899995803833 -> 0.9646999835968018
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2375.11 s

CURR EPOCH:  3

Epoch: 3 Summary
Mode: MODE.TRAIN
Losses: [0.02949193 0.11333269]
Metrics: {'Acc@1_broad': 0.99018, 'Acc@1_fine': 0.96084}
Best Acc@1_fine till now: 0.9502599835395813

Train Metrics increased from: 0.9502599835395813 -> 0.9608399868011475

Epoch: 3 Summary
Mode: MODE.EVAL
Losses: [0.011184  0.1023914]
Metrics: {'Acc@1_broad': 0.9964, 'Acc@1_fine': 0.9663}
Best Acc@1_fine till now: 0.9646999835968018

Eval Metrics increased from: 0.9646999835968018 -> 0.9663000106811523
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2375.15 s

CURR EPOCH:  4

Epoch: 4 Summary
Mode: MODE.TRAIN
Losses: [0.02729537 0.0951408 ]
Metrics: {'Acc@1_broad': 0.99072, 'Acc@1_fine': 0.96726}
Best Acc@1_fine till now: 0.9608399868011475

Train Metrics increased from: 0.9608399868011475 -> 0.9672600030899048

Epoch: 4 Summary
Mode: MODE.EVAL
Losses: [0.01121761 0.10623235]
Metrics: {'Acc@1_broad': 0.9968, 'Acc@1_fine': 0.9683}
Best Acc@1_fine till now: 0.9663000106811523

Eval Metrics increased from: 0.9663000106811523 -> 0.9682999849319458
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2374.85 s

CURR EPOCH:  5

Epoch: 5 Summary
Mode: MODE.TRAIN
Losses: [0.02557989 0.08262929]
Metrics: {'Acc@1_broad': 0.99114, 'Acc@1_fine': 0.9715}
Best Acc@1_fine till now: 0.9672600030899048

Train Metrics increased from: 0.9672600030899048 -> 0.9714999794960022

Epoch: 5 Summary
Mode: MODE.EVAL
Losses: [0.01090857 0.09405218]
Metrics: {'Acc@1_broad': 0.9966, 'Acc@1_fine': 0.972}
Best Acc@1_fine till now: 0.9682999849319458

Eval Metrics increased from: 0.9682999849319458 -> 0.972000002861023
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2373.60 s

CURR EPOCH:  6

Epoch: 6 Summary
Mode: MODE.TRAIN
Losses: [0.02409858 0.06499055]
Metrics: {'Acc@1_broad': 0.99178, 'Acc@1_fine': 0.9768}
Best Acc@1_fine till now: 0.9714999794960022

Train Metrics increased from: 0.9714999794960022 -> 0.9768000245094299

Epoch: 6 Summary
Mode: MODE.EVAL
Losses: [0.00996563 0.10559894]
Metrics: {'Acc@1_broad': 0.9969, 'Acc@1_fine': 0.9687}
Best Acc@1_fine till now: 0.972000002861023

Epoch took 2361.57 s

CURR EPOCH:  7

Epoch: 7 Summary
Mode: MODE.TRAIN
Losses: [0.02160459 0.05512383]
Metrics: {'Acc@1_broad': 0.99264, 'Acc@1_fine': 0.98034}
Best Acc@1_fine till now: 0.9768000245094299

Train Metrics increased from: 0.9768000245094299 -> 0.9803400039672852

Epoch: 7 Summary
Mode: MODE.EVAL
Losses: [0.00923083 0.10746382]
Metrics: {'Acc@1_broad': 0.9973, 'Acc@1_fine': 0.9699}
Best Acc@1_fine till now: 0.972000002861023

Epoch took 2361.41 s

CURR EPOCH:  8

Epoch: 8 Summary
Mode: MODE.TRAIN
Losses: [0.02165357 0.04431107]
Metrics: {'Acc@1_broad': 0.99266, 'Acc@1_fine': 0.98442}
Best Acc@1_fine till now: 0.9803400039672852

Train Metrics increased from: 0.9803400039672852 -> 0.9844200015068054

Epoch: 8 Summary
Mode: MODE.EVAL
Losses: [0.00898739 0.11021611]
Metrics: {'Acc@1_broad': 0.9973, 'Acc@1_fine': 0.9705}
Best Acc@1_fine till now: 0.972000002861023

Epoch took 2360.97 s

CURR EPOCH:  9

Epoch: 9 Summary
Mode: MODE.TRAIN
Losses: [0.0200738  0.03781054]
Metrics: {'Acc@1_broad': 0.99306, 'Acc@1_fine': 0.9868}
Best Acc@1_fine till now: 0.9844200015068054

Train Metrics increased from: 0.9844200015068054 -> 0.9868000149726868

Epoch: 9 Summary
Mode: MODE.EVAL
Losses: [0.00915725 0.10516673]
Metrics: {'Acc@1_broad': 0.9973, 'Acc@1_fine': 0.9722}
Best Acc@1_fine till now: 0.972000002861023

Eval Metrics increased from: 0.972000002861023 -> 0.9721999764442444
Model CKPT saved at: ./checkpoints/tf-vit-dual-model-p-16-huggingface-pretrained-google-weights-broad-only_1695545141.pt
Epoch took 2371.79 s

CURR EPOCH:  10
